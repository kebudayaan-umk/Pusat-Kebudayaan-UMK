<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tempahan Studio Pusat Kebudayaan UMK</title>
<style>
body {font-family: Arial, sans-serif; margin:20px; background:#f4f4f4;}
.container {background:#fff; padding:20px; margin-bottom:20px; border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,0.1);}
h1,h2 {color:#333; margin:0;}
h1 {display:flex; flex-direction:column; align-items:center; font-size:1.6em; margin-bottom:10px;}
h1 img {height:50px; margin-bottom:10px;}
label {display:block; margin-top:10px;}
input, select, textarea, button {width:100%; padding:8px; margin-top:4px; border-radius:4px; border:1px solid #ccc;}
button {width:auto; background:#0066cc; color:#fff; cursor:pointer;}
button:hover {background:#004a99;}
table {width:100%; border-collapse:collapse; margin-top:10px;}
th, td {border:1px solid #ccc; padding:8px; text-align:left;}
.status-approved {color:green; font-weight:bold;}
.status-pending {color:orange; font-weight:bold;}
.status-rejected {color:red; font-weight:bold;}
canvas {background:#fff; border:1px solid #ccc; margin-top:10px;}
.syarat {background:#f9f9f9; padding:10px; border:1px solid #ccc; border-radius:5px; margin-bottom:10px;}
a {color:#0066cc;}
</style>
</head>
<body>

<!-- HEADER DENGAN LOGO DAN MAKLUMAT HUBUNGAN -->
<div class="container" style="text-align:center;">
  <h1>
    <img src="assets/logo-umk.png" alt="Logo UMK">
    <span>Pusat Kebudayaan</span>
    <span>Universiti Malaysia Kelantan</span>
  </h1>
  <p>
    Email: <a href="mailto:kebudayaan@umk.edu.my">kebudayaan@umk.edu.my</a><br>
    No. Telefon: +6097797436
  </p>
</div>

<!-- BORANG PERMOHONAN -->
<div class="container" id="tempahan">
  <h2>Permohonan Tempahan Studio UMK</h2>
  <form id="bookingForm">
    <h3>Maklumat Pemohon</h3>
    <label>Nama Penuh<input required></label>
    <label>No. Matrik / Staf / Kad Pengenalan<input required></label>
    <label>Jawatan
      <select required>
        <option value="">-- Pilih --</option>
        <option>Pelajar</option>
        <option>Staf Akademik</option>
        <option>Staf Pentadbiran</option>
        <option>Orang Awam</option>
      </select>
    </label>
    <label>Fakulti / Pusat / Jabatan<input required></label>
    <label>Email<input type="email" placeholder="nama@email.com" required></label>

    <h3>Maklumat Tempahan</h3>
    <label>Kampus
      <select id="campusSelect" required>
        <option value="">-- Sila Pilih Kampus --</option>
        <option value="Bachok">Kampus Bachok</option>
        <option value="Kota">Kampus Kota</option>
        <option value="Jeli">Kampus Jeli</option>
      </select>
    </label>
    <label>Studio
      <select id="studioSelect" required>
        <option value="">-- Sila Pilih Kampus Dahulu --</option>
      </select>
    </label>
    <label>Tarikh Tempahan<input type="date" required></label>
    <label>Masa Mula<input type="time" required></label>
    <label>Masa Tamat<input type="time" required></label>
    <label>Nama / Tujuan Aktiviti<input required></label>
    <label>Bilangan Peserta<input type="number" min="1" required></label>
    <label>Keperluan Khas (jika ada)<textarea placeholder="Contoh: sistem audio, mikrofon"></textarea></label>

    <!-- SYARAT & PERATURAN -->
    <div class="syarat">
      <p>1. Borang permohonan perlu dipohon <strong>TIGA (3) hari</strong> sebelum tarikh penggunaan.</p>
      <p>2. Pemohon hendaklah memahami dan mematuhi syarat-syarat, garis panduan dan etika penggunaan kemudahan yang telah ditetapkan oleh Universiti.</p>
      <p>3. Pemohon hendaklah bertanggungjawab terhadap keadaan, keselamatan, kerosakan kemudahan yang digunakan.</p>
      <p>4. Pemohon tidak dibenarkan mengubahsuai kedudukan peralatan di dalam tempat yang digunakan.</p>
      <p><strong>PEMOHON HENDAKLAH MEMBAYAR DENDA DAN GANTIRUGI TERHADAP SEBARANG KEKOTORAN DAN KEROSAKAN KEMUDAHAN YANG DIGUNAKAN.</strong></p>
    </div>

    <!-- Checkbox persetujuan di sebelah teks -->
    <label style="display:flex; align-items:center; margin-top:10px;">
      <input type="checkbox" required style="margin-right:8px;">
      <span>Saya telah membaca, memahami dan bersetuju dengan semua syarat dan peraturan permohonan di atas</span>
    </label>
    <br>
    <button type="submit">Hantar Permohonan</button>
  </form>
</div>

<!-- DASHBOARD ADMIN -->
<div class="container" id="admin">
  <h2>Dashboard Admin Mengikut Kampus</h2>
  <label>Pilih Kampus Admin
    <select id="adminCampus">
      <option value="">-- Pilih Kampus --</option>
      <option value="Bachok">Kampus Bachok</option>
      <option value="Kota">Kampus Kota</option>
      <option value="Jeli">Kampus Jeli</option>
    </select>
  </label>
  <table id="adminTable">
    <tr><th>Nama</th><th>Kampus</th><th>Studio</th><th>Tarikh</th><th>Status</th><th>Tindakan</th></tr>
  </table>
</div>

<!-- LAPORAN & JADUAL -->
<div class="container" id="jadual">
  <h2>Laporan & Jadual Tempahan Mengikut Kampus</h2>
  <label>Pilih Kampus
    <select id="reportCampus">
      <option value="">-- Semua Kampus --</option>
      <option value="Bachok">Kampus Bachok</option>
      <option value="Kota">Kampus Kota</option>
      <option value="Jeli">Kampus Jeli</option>
    </select>
  </label>
  <table id="scheduleTable">
    <tr><th>Kampus</th><th>Studio</th><th>Tarikh</th><th>Masa</th><th>Status</th></tr>
  </table>
</div>

<!-- STATISTIK PENGGUNAAN -->
<div class="container" id="statistik">
  <h2>Statistik Penggunaan Studio</h2>
  <canvas id="usageChart" height="120"></canvas>
</div>

<script>
const bookings=[];
const studioByCampus={Bachok:['Teniat 3','Teniat 4'],Kota:['Studio Tari','Studio Band','Studio Gamelan'],Jeli:['Surau Lama','Dewan Utama']};
const form=document.getElementById('bookingForm');
const campusSelect=document.getElementById('campusSelect');
const studioSelect=document.getElementById('studioSelect');
const adminTable=document.getElementById('adminTable');
const scheduleTable=document.getElementById('scheduleTable');
const chartCanvas=document.getElementById('usageChart');
const chartCtx=chartCanvas.getContext('2d');

campusSelect.addEventListener('change',()=>{
  const campus=campusSelect.value;
  studioSelect.innerHTML='<option value="">-- Sila Pilih Studio --</option>';
  if(studioByCampus[campus]){
    studioByCampus[campus].forEach(s=>{
      const opt=document.createElement('option');
      opt.textContent=s;
      studioSelect.appendChild(opt);
    });
  }
});

form.addEventListener('submit',e=>{
  e.preventDefault();
  const data={
    name:form[0].value,
    campus:campusSelect.value,
    studio:studioSelect.value,
    date:form.querySelector('input[type="date"]').value,
    time:form.querySelectorAll('input[type="time"]')[0].value+' - '+form.querySelectorAll('input[type="time"]')[1].value,
    status:'Pending'
  };
  bookings.push(data);
  render();
  form.reset();
  alert('Permohonan berjaya dihantar');
});

function render(){
  const adminCampus=document.getElementById('adminCampus').value;
  const reportCampus=document.getElementById('reportCampus').value;

  adminTable.innerHTML='<tr><th>Nama</th><th>Kampus</th><th>Studio</th><th>Tarikh</th><th>Status</th><th>Tindakan</th></tr>';
  scheduleTable.innerHTML='<tr><th>Kampus</th><th>Studio</th><th>Tarikh</th><th>Masa</th><th>Status</th></tr>';

  bookings.forEach((b,i)=>{
    if(!adminCampus || b.campus===adminCampus){
      adminTable.innerHTML+=`<tr>
        <td>${b.name}</td>
        <td>${b.campus}</td>
        <td>${b.studio}</td>
        <td>${b.date}</td>
        <td class="status-${b.status.toLowerCase()}">${b.status}</td>
        <td>
          <button onclick="approve(${i})">Lulus</button>
          <button onclick="reject(${i})">Tolak</button>
        </td>
      </tr>`;
    }
    if(b.status==='Approved' && (!reportCampus || b.campus===reportCampus)){
      scheduleTable.innerHTML+=`<tr>
        <td>${b.campus}</td>
        <td>${b.studio}</td>
        <td>${b.date}</td>
        <td>${b.time}</td>
        <td>${b.status}</td>
      </tr>`;
    }
  });
  drawChart();
}

function approve(i){bookings[i].status='Approved'; render();}
function reject(i){bookings[i].status='Rejected'; render();}

function drawChart(){
  const counts={Bachok:0,Kota:0,Jeli:0};
  bookings.forEach(b=>{if(b.status==='Approved') counts[b.campus]++;});
  chartCtx.clearRect(0,0,chartCanvas.width,chartCanvas.height);
  const labels=Object.keys(counts);
  const values=Object.values(counts);
  const barWidth=80,gap=60,max=Math.max(...values,1);
  values.forEach((v,i)=>{
    const h=(v/max)*100;
    const x=50+i*(barWidth+gap);
    chartCtx.fillStyle='blue';
    chartCtx.fillRect(x,120-h,barWidth,h);
    chartCtx.fillStyle='black';
    chartCtx.fillText(labels[i],x,135);
    chartCtx.fillText(v,x+30,110-h);
  });
}
</script>
</body>
</html>
